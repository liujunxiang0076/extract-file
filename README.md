# Excel预算文件信息提取工具（基于Python）-个人项目使用

这是一个用于从Excel预算文件中提取关键信息的工具。该工具可以从多个Excel文件中批量提取预算编号、合同号、部门信息等数据，并生成汇总Excel表格。

## 功能特点

- 支持批量处理多个Excel文件(`.xlsx`和`.xls`格式)
- 智能识别并提取关键字段：
  - 事业部预算编号
  - 合同号
  - 部门信息
  - 单据编号
  - 备注信息
  - 制单日期
  - 制单人
- 自动验证文件名与预算编号的一致性
- 支持GUI图形界面和命令行模式
- 生成统计信息(处理文件数、匹配/不匹配数量等)
- 格式化的输出Excel表格，支持冻结首行、自动调整列宽等

## 安装依赖

```bash
# 安装依赖库
pip install pandas openpyxl xlrd
```

## 使用方法

### 图形界面模式

直接运行脚本即可启动图形界面：

```bash
python dlzb_budget_file.py
```

在图形界面中：
1. 点击"浏览..."选择Excel文件所在文件夹
2. 设置输出文件名(默认为"预算文件列表.xlsx")
3. 选择是否提取Excel文件内容
4. 点击"开始处理"按钮开始提取
5. 可以通过"创建测试文件"按钮生成测试数据

### 命令行模式

也可以通过命令行直接指定参数运行：

```bash
python dlzb_budget_file.py [参数]
```

或者在代码中直接调用：

```python
from dlzb_budget_file import extract_filenames_to_excel

# 提取文件信息
extract_filenames_to_excel("Excel文件夹路径", "输出文件名.xlsx", True)
```

## 输出结果

生成的Excel文件包含以下内容：
- 文件名
- 事业部预算编号
- 合同号
- 部门（显示值）
- 单据编号
- 备注
- 制单日期
- 制单人

此外，还会生成一个统计信息工作表，包含：
- 总文件数
- 成功处理文件数
- 预算编号匹配文件数
- 预算编号不匹配文件数
- 从文件名提取预算编号数
- 各字段缺失文件数量

## 数据提取方法

工具使用多种方法提取预算Excel文件中的信息：

1. **关键字搜索**: 搜索特定关键字如"事业部预算编号"、"合同号"等并提取对应值
2. **固定坐标定位**: 针对标准模板，使用固定坐标如A4(事业部预算编号)、G4(合同号)等直接提取
3. **列扫描**: 扫描特定列（如D列查找制单日期，A列查找制单人）
4. **正则匹配**: 使用正则表达式识别特定格式的内容
5. **文件名提取**: 当无法从内容中提取时，尝试从文件名中提取预算编号

## 注意事项

- 该工具主要针对特定格式的预算Excel文件设计
- 支持多种布局的Excel文件识别
- 自动清理提取的数据，移除包含的列标题和多余空格
- 如果无法从Excel内容中提取预算编号，将尝试从文件名中提取
- 程序会验证提取的预算编号与文件名的一致性 
